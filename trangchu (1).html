<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <title>Home</title>
  <style>
    html,
    body {
      height: 100%;
      /* Rất quan trọng để h-100 hoạt động */
    }
  </style>
</head>

<body>
  <div class="h-25 d-flex align-items-center justify-content-between bg-primary text-light px-5">
    <div class="fs-3 fw-bold">CHÀO MỪNG BẠN ĐẾN VỚI ĐỌC TRUYỆN ONLINE MỖI NGÀY</div>
    <div class="d-flex gap-2">
      <div id="userInfo" class="d-none dropdown d-flex align-items-center gap-2">
        <img id="userAvatar" src="" alt="Avatar" class="rounded-circle dropdown-toggle" data-bs-toggle="dropdown"
          width="30" height="30" role="button">
        <ul class="dropdown-menu bg-danger">
          <li><a class="dropdown-item bg-danger fw-bold text-light" href="#" onclick="editUserForm()">Thông Tin người dùng</a></li>
          <li><a class="dropdown-item bg-danger fw-bold text-light" href="#" onclick="logOutUser()">Đăng Xuất</a></li>
        </ul>
        <span id="userName" class="fw-bold text-white fs-14"></span>
      </div>

      <button id="loginButton" type="button" class="btn btn-light fw-bold w-20 text-primary"
        onclick="toggleLoginForm()"><i class="bi bi-person fw-bold"></i>Đăng Nhập</button>
      <button class="btn btn-light">
        <i class="bi bi-bookmark-check-fill fs-6 text-primary"></i>
      </button>
    </div>
  </div>
  <!-- form đăng nhập bị ẩn -->
  <div id="loginForm" class="container mt-4 d-none justify-content-between align-items-center px-4 w-50">
    <div class="card p-4 shadow">
      <h4 class="mb-3 text-center fw-bold">Đăng Nhập</h4>
      <form id="loginFormElement" onsubmit="loginUser(event)">
        <div class="mb-3">
          <label for="email" class="form-label">Email:</label>
          <input type="email" class="form-control" id="email" placeholder="Nhập email">
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Mật khẩu:</label>
          <input type="password" class="form-control" id="password" placeholder="Nhập mật khẩu">
        </div>
        <div class="text-center">
          <button type="submit" class="btn btn-primary" onclick="loginUser()">Đăng Nhập</button>
          <button type="button" class="btn btn-danger" onclick="cancelLogin()">Hủy</button><br>
          <a href="" class="fs-6 fst-italic" onclick="toggleRegisterForm(event)">Nếu chưa có tài khoản hãy đăng kí</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Form đăng kí bị ẩn -->
  <div id="registerForm" class="container mt-4 d-none justify-content-between align-items-center px-4 w-50">
    <div class="card p-4 shadow">
      <h4 class="mb-3 text-center fw-bold">Đăng Ký</h4>
      <form id="registerFormElement">
        <div class="mb-3">
          <label for="avatar" class="form-label">Chọn ảnh đại diện:</label>
          <input type="file" class="form-control" id="avatar">
        </div>
        <div class="mb-3">
          <label for="fullName" class="form-label">Họ và Tên:</label>
          <input type="text" class="form-control" id="fullName" placeholder="Nhập họ và tên">
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email:</label>
          <input type="email" class="form-control" id="registerEmail" placeholder="Nhập email">
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Mật khẩu:</label>
          <input type="password" class="form-control" id="registerPassword" placeholder="Nhập mật khẩu">
        </div>
        <div class="mb-3">
          <label for="confirmPassword" class="form-label">Xác nhận mật khẩu:</label>
          <input type="password" class="form-control" id="confirmPassword" placeholder="Nhập lại mật khẩu">
        </div>
        <div class="text-center">
          <button type="button" class="btn btn-primary" onclick="registerUser()">Đăng Ký</button>
          <button type="button" class="btn btn-danger" onclick="cancelRegister()">Hủy</button><br>
          <a href="" class="fs-6 fst-italic" onclick="toggleLoginForm()">Quay lại đăng nhập</a>
        </div>
      </form>
    </div>
  </div>
  <!-- form sửa thông tin người dùng -->
  <div id="editUserForm" class="container mt-4 d-none justify-content-between align-items-center px-4 w-50">
    <div class="card p-4 shadow">
      <h4 class="mb-3 text-center fw-bold">Thông Tin Người Dùng</h4>
      <form id="editUserFormElement">
        <div class="mb-3">
          <label for="avatar" class="form-label">Chọn ảnh đại diện:</label>
          <input type="file" class="form-control" id="editAvatar">
        </div>
        <div class="mb-3">
          <label for="fullName" class="form-label">Họ và Tên:</label>
          <input type="text" class="form-control" id="editFullName" placeholder="Nhập họ và tên">
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email:</label>
          <input type="email" class="form-control" id="editEmail" placeholder="Nhập email">
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Mật khẩu:</label>
          <input type="password" class="form-control" id="editPassword" placeholder="Nhập mật khẩu">
        </div>
        <div class="mb-3">
          <label for="confirmPassword" class="form-label">Xác nhận mật khẩu:</label>
          <input type="password" class="form-control" id="editConfirmPassword" placeholder="Nhập lại mật khẩu">
        </div>
        <div id="editError" class="text-danger mb-3"></div>
        <div class="text-center">
          <button type="submit" class="btn btn-primary" onclick="saveEditUserForm()">Lưu Thay Đổi</button>
          <button type="button" class="btn btn-danger" onclick="cancelEditUserForm()">Hủy</button><br>
        </div>
      </form>
    </div>
  </div>
  <!-- thanh navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <div class="navbar-nav d-flex justify-content-around w-100">
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Truyện Ngắn</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Tình yêu</a></li>
            <li><a class="dropdown-item" href="#">Gia đình</a></li>
            <li><a class="dropdown-item" href="#">Cuộc sống</a></li>
            <li><a class="dropdown-item" href="#">Học đường</a></li>
            <li><a class="dropdown-item" href="#">Tâm lý – Xã hội</a></li>
            <li><a class="dropdown-item" href="#">Truyện ngắn hài hước</a></li>
            <li><a class="dropdown-item" href="#">Truyện ngắn kinh dị</a></li>
            <li><a class="dropdown-item" href="#">Truyện ngắn kỳ ảo</a></li>
            <li><a class="dropdown-item" href="#">Truyện cổ điển – văn học Việt Nam</a></li>
            <li><a class="dropdown-item" href="#">Truyện nước ngoài dịch</a></li>
          </ul>
        </div>
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Truyện Dài</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Truyện tình cảm dài kỳ</a></li>
            <li><a class="dropdown-item" href="#">Truyện phiêu lưu - hành động</a></li>
            <li><a class="dropdown-item" href="#">Truyện kiếm hiệp</a></li>
            <li><a class="dropdown-item" href="#">Truyện huyền bí - kỳ ảo</a></li>
            <li><a class="dropdown-item" href="#">Truyện khoa học viễn tưởng </a></li>
            <li><a class="dropdown-item" href="#">Truyện cổ điển nổi tiếng</a></li>
            <li><a class="dropdown-item" href="#">Truyện dài thiếu nhi</a></li>
            <li><a class="dropdown-item" href="#">Truyện tâm lý xã hội</a></li>
            <li><a class="dropdown-item" href="#">Truyện chiến tranh - cách mạng</a></li>
          </ul>
        </div>
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Truyện Cười</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Truyện cười dân gian Việt Nam</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười học đường</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười gia đình</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười công sở</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười tình yêu</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười ngắn (1-3 dòng)</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười nghề nghiệp (bác sĩ, luật sư, kỹ sư...)</a></li>
            <li><a class="dropdown-item" href="#">Truyện cười thiếu nhi</a></li>
          </ul>
        </div>
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Truyện Cổ Tích</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Tấm Cám</a></li>
            <li><a class="dropdown-item" href="#">Thạch Sanh</a></li>
            <li><a class="dropdown-item" href="#">Cây tre trăm đốt</a></li>
            <li><a class="dropdown-item" href="#">Sọ Dừa</a></li>
            <li><a class="dropdown-item" href="#">Chử Đồng Tử</a></li>
            <li><a class="dropdown-item" href="#">Cây khế</a></li>
            <li><a class="dropdown-item" href="#">Sự tích trầu cau</a></li>
            <li><a class="dropdown-item" href="#">Sự tích bánh chưng, bánh giầy</a></li>
            <li><a class="dropdown-item" href="#">Con rồng cháu tiên</a></li>
          </ul>
        </div>
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Truyện Lịch Sử</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Lịch sử thời phong kiến</a></li>
            <li><a class="dropdown-item" href="#">Lịch sử chống Pháp</a></li>
            <li><a class="dropdown-item" href="#">Lịch sử chống Nhật</a></li>
            <li><a class="dropdown-item" href="#">Lịch sử chống Pháp lần 2</a></li>
            <li><a class="dropdown-item" href="#">Lịch sử chống Mỹ</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
  <div class="container mt-4">
    <h1 class="text-center mb-4">Danh sách truyện</h1>
    <div class="mb-4">
      <input type="text" id="search" class="form-control" placeholder="Tìm kiếm truyện...">
    </div>
  <main>
    <h4 class="px-2 mt-2" style="font-family: 'Segoe UI';">TRUYỆN HOT HIT</h4>
    <style>
      .img {
        width: 100%;
        height: 350px;
        object-fit: cover;
      }
      .btn-hiden {
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .btn-hiden:hover {
    background-color: #eeff00; /* Màu xám đậm hơn khi hover */
    transform: translateY(-10px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
  }

  .btn-hiden:active {
    transform: translateY(1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
    </style>
    
    <div class="container">
            <div id="bookList" class="row"></div>
            <script>
              async function fetchBooks() {
              try {
                const response = await fetch('https://6819bb531ac11556350604df.mockapi.io/products'); // Replace with your actual mock API URL
                const books = await response.json();

                const bookList = document.getElementById('bookList');
                bookList.innerHTML = ''; // Clear existing content

                books.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'col-md-4 mb-3';
                bookCard.innerHTML = `
                  <div class="card h-100">
                  <img src="${book.image}" class="card-img-top img" alt="${book.title}">
                  <button class="btn btn-hiden  btn-secondary">Thêm Vào Giỏ</button>
                  <div class="card-body">
                    <h5 class="card-title">${book.title}</h5>
                    <p class="card-text ">Thể loại: ${book.category}</p>
                    <p class="card-text"><strong>Giá:</strong> ${book.price} VNĐ</p>
                    <butnon class="btn btn-hiden btn-primary">Xem Chi Tiết</button>
                    
                  </div>
                  </div>
                `;
                bookList.appendChild(bookCard);
                });
              } catch (error) {
                console.error('Error fetching books:', error);
              }
              }

              document.addEventListener('DOMContentLoaded', fetchBooks);
            </script>
  </main>

  <footer>
    <p>&copy; 2025 Trang Web Mẫu. Đã đăng ký bản quyền.</p>
  </footer>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
</script>
<script>
  function toggleLoginForm() {
    event.preventDefault(); // Tránh load lại trang
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');

    registerForm.classList.add('d-none');  // Ẩn form đăng ký nếu đang mở
    loginForm.classList.remove('d-none'); // Hiện form đăng nhập
  }
  function cancelLogin() {
    const form = document.getElementById('loginFormElement');
    form.reset();  // Xóa sạch tất cả dữ liệu trong form
    document.getElementById('loginForm').classList.add('d-none'); // Ẩn form
  }
  function toggleRegisterForm(event) {
    event.preventDefault();
    const registerForm = document.getElementById("registerForm");
    registerForm.classList.toggle("d-none");
    const loginForm = document.getElementById("loginForm");
    loginForm.classList.add("d-none"); // Ẩn form đăng nhập khi mở form đăng ký
  }

  function cancelRegister() {
    const form = document.getElementById("registerFormElement");
    form.reset();  // Xóa sạch tất cả dữ liệu trong form
    document.getElementById('registerForm').classList.add('d-none'); // Ẩn form
  }
  // fake api 
  function registerUser() {
  const name = document.getElementById("fullName").value.trim();
  const email = document.getElementById("registerEmail").value.trim();
  const password = document.getElementById("registerPassword").value.trim();
  const confirmPassword = document.getElementById("confirmPassword").value.trim();
  const avatarInput = document.getElementById("avatar");

  const users = JSON.parse(localStorage.getItem("users")) || [];

  if (!name || !email || !password || !confirmPassword) {
    alert("Vui lòng nhập đầy đủ thông tin.");
    return;
  }

  if (password !== confirmPassword) {
    alert("Mật khẩu xác nhận không khớp.");
    return;
  }

  if (users.find(u => u.email === email)) {
    alert("Email này đã được đăng ký.");
    return;
  }

  const newUser = { name, email, password, avatar: "" };

  if (avatarInput.files.length > 0) {
    const reader = new FileReader();
    reader.onload = function (e) {
      newUser.avatar = e.target.result;
      users.push(newUser);
      localStorage.setItem("users", JSON.stringify(users));
      alert("Đăng ký thành công!");
      cancelRegister();
    };
    reader.readAsDataURL(avatarInput.files[0]);
  } else {
    users.push(newUser);
    localStorage.setItem("users", JSON.stringify(users));
    alert("Đăng ký thành công!");
    cancelRegister();
  }
}

  // kiểm tra api khi users đăng nhập
  function loginUser(event) {
    event.preventDefault(); // Ngăn trang reload

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const users = JSON.parse(localStorage.getItem("users")) || [];
    const user = users.find(u => u.email === email && u.password === password);

    if (!email || !password) {
      alert("Vui lòng nhập email và mật khẩu.");
      return;
    }
    if (user) {
      alert(`Xin chào, ${user.name}`);
      localStorage.setItem("loggedInUser", JSON.stringify(user));

      // Hiển thị thông tin người dùng
      document.getElementById("loginButton").classList.add("d-none");
      document.getElementById("userInfo").classList.remove("d-none");

      // Gán thông tin người dùng
      document.getElementById("userName").textContent = user.name;
      document.getElementById("userAvatar").src = user.avatar || "https://via.placeholder.com/30";

      // Ẩn form sau khi đăng nhập
      document.getElementById("loginForm").classList.add("d-none");
    } else {
      alert("Email hoặc mật khẩu không đúng!");
    }
  }
  function logOutUser() {
    localStorage.removeItem("loggedInUser");
    location.reload();
  }

  function editUserForm() {
  const formContainer = document.getElementById('editUserForm');
  const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

  if (!loggedInUser) {
    alert("Không tìm thấy thông tin người dùng.");
    return;
  }

  // Hiển thị form
  formContainer.classList.remove('d-none');

  // Gán giá trị vào các input
  document.getElementById("editFullName").value = loggedInUser.name;
  document.getElementById("editEmail").value = loggedInUser.email;
  document.getElementById("editPassword").value = loggedInUser.password;
  document.getElementById("editConfirmPassword").value = loggedInUser.password;
  // Nếu có hình đại diện, hiển thị
  if (loggedInUser.avatar) {
    document.getElementById("editAvatar").src = loggedInUser.avatar;
  }
}
  function cancelEditUserForm() {
    const formContainer = document.getElementById('editUserForm');
    formContainer.classList.add('d-none');
}
function saveEditUserForm() {
  const name = document.getElementById("editFullName").value.trim();
  const email = document.getElementById("editEmail").value.trim();
  const password = document.getElementById("editPassword").value.trim();
  const confirmPassword = document.getElementById("editConfirmPassword").value.trim();
  const errorContainer = document.getElementById("editError");

  errorContainer.innerText = "";

  if (!name || !email || !password || !confirmPassword) {
    errorContainer.innerText = "Vui lòng nhập đầy đủ thông tin.";
    return;
  }

  if (password !== confirmPassword) {
    errorContainer.innerText = "Mật khẩu xác nhận không khớp.";
    return;
  }

  const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
  const users = JSON.parse(localStorage.getItem("users")) || [];

  // Tìm user đang đăng nhập trong danh sách users
  const index = users.findIndex(u => u.email === loggedInUser.email);
  if (index !== -1) {
    // Cập nhật thông tin người dùng trong danh sách users
    users[index] = {
      ...users[index],
      name: name,
      email: email,
      password: password
    };

    // Cập nhật lại thông tin người dùng trong localStorage
    localStorage.setItem("users", JSON.stringify(users));
    localStorage.setItem("loggedInUser", JSON.stringify(users[index]));

    // Cập nhật thông tin người dùng trong header
    document.getElementById("userName").textContent = name;
    document.getElementById("userAvatar").src = users[index].avatar || "https://via.placeholder.com/30";

    alert("Cập nhật thông tin thành công!");
    cancelEditUserForm(); // Hide the edit form after saving
  } else {
    alert("Không tìm thấy người dùng.");
  }
}


</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
  const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
  const userInfo = document.getElementById("userInfo");
  const userName = document.getElementById("userName");
  const loginButton = document.getElementById("loginButton");
  const userAvatar = document.getElementById("userAvatar");

  if (loggedInUser) {
    userInfo.classList.remove("d-none");
    userName.textContent = loggedInUser.name; 
    userAvatar.src = loggedInUser.avatar; 
    if (loginButton) {
      loginButton.classList.add("d-none");
    }
  } else {
    userInfo.classList.add("d-none");
    if (loginButton) {
      loginButton.classList.remove("d-none");
    }
  }
});

</script>

</html>